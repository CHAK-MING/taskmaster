name: Sensor Example
description: Demonstrates all sensor types (file, http, command)

tasks:
  # File Sensor - waits for a file to exist
  - id: wait_for_file
    name: Wait for Input File
    executor: sensor
    sensor_type: file
    sensor_path: /tmp/taskmaster_input.txt
    sensor_interval: 5
    timeout: 60
    command: "true"

  - id: process_file
    name: Process Input
    command: echo "Processing file content from /tmp/taskmaster_input.txt"
    dependencies: [wait_for_file]

  # HTTP Sensor - waits for an HTTP endpoint to return expected status
  - id: wait_for_api
    name: Wait for API Ready
    executor: sensor
    sensor_type: http
    sensor_url: http://localhost:8080/health
    sensor_expected_status: 200
    sensor_interval: 5
    timeout: 60
    command: "true"

  - id: call_api
    name: Call API
    command: echo "API is ready, making request"
    dependencies: [wait_for_api]

  # Command Sensor - waits for a command to exit with 0
  - id: check_service
    name: Check External Service
    executor: sensor
    sensor_type: command
    command: "[ -f /tmp/service_ready ] && exit 0 || exit 1"
    sensor_interval: 3
    timeout: 30

  - id: call_service
    name: Call Service
    command: echo "Service is ready"
    dependencies: [check_service]

  - id: complete
    name: All Done
    command: echo "All sensors passed, workflow complete"
    dependencies: [process_file, call_api, call_service]
    trigger_rule: all_done
