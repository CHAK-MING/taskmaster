name: Docker Executor Example
description: Demonstrates running tasks in Docker containers
tasks:
  - id: alpine_hello
    name: Alpine Hello
    executor: docker
    docker_image: alpine:latest
    pull_policy: if_not_present
    command: echo "Hello from Alpine container!"

  - id: busybox_info
    name: BusyBox System Info
    executor: docker
    docker_image: busybox:latest
    pull_policy: if_not_present
    command: |
      echo '{"hostname":"'$(hostname)'","date":"'$(date -Iseconds)'"}'
    xcom_push:
      - key: info
        source: json

  - id: ubuntu_process
    name: Ubuntu Process Data
    executor: docker
    docker_image: ubuntu:22.04
    pull_policy: if_not_present
    command: |
      echo "Processing data from: $CONTAINER_INFO"
      echo "Processed 100 records"
    dependencies: [busybox_info]
    xcom_pull:
      - key: info
        from: busybox_info
        env: CONTAINER_INFO
    xcom_push:
      - key: count
        source: stdout
        regex: "Processed (\\d+)"
        regex_group: 1

  - id: shell_summary
    name: Shell Summary
    command: echo "Docker pipeline complete. Records processed - $RECORD_COUNT"
    dependencies: [alpine_hello, ubuntu_process]
    xcom_pull:
      - key: count
        from: ubuntu_process
        env: RECORD_COUNT
