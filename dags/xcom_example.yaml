name: XCom Data Pipeline Example
description: Demonstrates cross-task communication (XCom) for passing data between tasks
tasks:
  - id: generate_data
    name: Generate Data
    command: echo '{"batch_id":"batch_001","records":42,"status":"ready"}'
    xcom_push:
      - key: result
        source: json

  - id: validate_data
    name: Validate Data
    command: |
      echo "Validating: $BATCH_DATA"
      echo '{"valid":true,"count":42}'
    dependencies: [generate_data]
    xcom_pull:
      - key: result
        from: generate_data
        env: BATCH_DATA
    xcom_push:
      - key: validation
        source: json

  - id: process_data
    name: Process Data
    command: |
      echo "Processing count: $VALID_COUNT"
      echo "Result: 42 records processed"
    dependencies: [validate_data]
    xcom_pull:
      - key: validation
        from: validate_data
        env: VALID_COUNT
    xcom_push:
      - key: processed
        source: stdout
        regex: "Result: (\\d+)"
        regex_group: 1

  - id: notify
    name: Send Notification
    command: |
      echo "Pipeline complete!"
      echo "Processed: $PROCESSED_COUNT"
    dependencies: [process_data]
    xcom_pull:
      - key: processed
        from: process_data
        env: PROCESSED_COUNT
